@model PersonDataModel

<section class="content" lang="ar" dir="rtl">
    <div class="row">
        <div class="col-lg-12 col-12">
            <div class="box">

                <form class="form" asp-action="Create" method="post" enctype="multipart/form-data">
                    <div class="box-body">
                        <h4 class="box-title text-info mb-0"><i class="ti-user me-15"></i>بيانات المتضرر</h4>
                        <hr class="my-15">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="Name"> </label>
                                    <input type="text" asp-for="Name" maxlength="100" class="form-control">
                                    <span asp-validation-for="Name" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="Iqama"> </label>
                                    <input type="number" asp-for="Iqama" maxlength="25" class="form-control">
                                    <span asp-validation-for="Iqama" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="PhoneNumber"></label>
                                    <input type="text" asp-for="PhoneNumber" maxlength="12" min="9" class="form-control">
                                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="DamageTypeId"> </label>
                                    <select class="form-control" asp-for="DamageTypeId" asp-items="@ViewBag.lst_DamageTypes">
                                        <option value="" selected>اختار</option>
                                    </select>
                                    <span asp-validation-for="DamageTypeId" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="BankTypesId"></label>
                                    <select class="form-control SelectBank" asp-for="BankTypesId" asp-items="@ViewBag.lst_BankTypes">
                                        <option value="" selected>اختار </option>
                                    </select>
                                    <span asp-validation-for="BankTypesId" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="IBAN"> </label>
                                    <input readonly type="text" asp-for="IBAN" maxlength="24" class="form-control">
                                    <span asp-validation-for="IBAN" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="DamageDate"> </label>
                                    <input asp-for="DamageDate" class="form-control">
                                    <span asp-validation-for="DamageDate" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <h4 class="box-title text-info mb-0"><i class="ti-user me-15"></i>بيانات موقع الضرر</h4>
                        <hr class="my-15">

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="RegionsId"> </label>
                                    <select class="form-control" asp-for="RegionsId" asp-items="@ViewBag.lst_regions">
                                        <option value="" selected>اختار</option>
                                    </select>
                                    <span asp-validation-for="RegionsId" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="City"></label>
                                    <input type="text" asp-for="City" maxlength="50" class="form-control">
                                    <span asp-validation-for="City" class="text-danger"></span>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="AreaQuarter"></label>
                                    <input type="text" asp-for="AreaQuarter" maxlength="50" class="form-control">
                                    <span asp-validation-for="AreaQuarter" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="Street"></label>
                                    <input type="text" asp-for="Street" maxlength="50" class="form-control">
                                    <span asp-validation-for="Street" class="text-danger"></span>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="PostalCode"></label>
                                    <input type="text" asp-for="PostalCode" maxlength="5" class="form-control">
                                    <span asp-validation-for="PostalCode" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="formFile" class="form-label" asp-for="DamageImage"></label>
                                    <input class="form-control" asp-for="DamageImageFile" type="file" accept="image/*" id="formFile">
                                </div>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="formfile" class="form-label" asp-for="VehicleImage"></label>
                                    <input class="form-control" asp-for="VehicleImageFile" type="file" accept="image/*" id="formfile">
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="form-label" asp-for="InsurranceId"> </label>
                                    <select class="form-control" asp-for="InsurranceId" asp-items="@ViewBag.insurrances" required>
                                        <option value="" selected>اختار</option>
                                    </select>
                                    <span asp-validation-for="InsurranceId" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="box-footer">

                            <button type="submit" class="btn btn-primary" data-app-disable-on-submit="true">
                                <i class="ti-save-alt"></i> حفظ
                            </button>
                        </div>
                    </div>
                </form>
            </div>
            <!-- /.box -->
        </div>
    </div>


</section>
@section Scripts{
    <script type="text/javascript">

        $(document).ready(function () {

            $('.SelectBank').on('change', function () {
                
                var data = { BankId: this.value }
                $.ajax({
                    url: '/Home/GetIBan',
                    type: 'POST',
                    data: data,
                    success: function (res) {
                        console.log(res);
                        $('#IBAN').val(res);
                    },
                    error: function (err) {
                        console.log(err);
                    }
                });

            });



            var MsgCreate = '@TempData["MsgCreate"]';

            if (MsgCreate.length != 0) {
                if (MsgCreate == '1') {
                    alert("تمت الاضافه بنجاح")
                } else if (MsgCreate == '3') {
                    alert("حدث خطأ اثناء الاضافة,حاول مره اخرى")
                } else if (MsgCreate == '4') {
                    alert("حدث خطأ اثناء رفع صورة الضرر ,حاول مره اخرى")
                }
                else if (MsgCreate == '5') {
                    alert("حدث خطأ اثناء رفع صورة المركبة ,حاول مره اخرى")
                }
               
            }
            $('form').submit(function (e) {
                $('button[type="submit"]', this).attr('disabled', 'disabled');
            });
        });

    </script>
}